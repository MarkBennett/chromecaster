<html>
    <body>
        <script type="text/javascript" src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js"></script>
        <script>
(function() {
  var APPLICATION_ID = "7501E4AA";
  var MSG_NAMESPACE = "urn:x-cast:ca.burmis.namespace";
  
  window['__onGCastApiAvailable'] = function(loaded, errorInfo) {
    if (loaded) {
      initializeCastApi();
    } else {
      console.log(errorInfo);
    }
  }
  
  function initializeCastApi() {
    console.log("Initializing Cast...");
    
    var sessionRequest = new chrome.cast.SessionRequest(APPLICATION_ID);
    var apiConfig = new chrome.cast.ApiConfig(sessionRequest,
      sessionListener,
      receiverListener);
    chrome.cast.initialize(apiConfig, onInitSuccess, onError);
  }

  function receiverListener(e) {
    console.log("Receiver event");
    console.dir(e);
    
    if( e === chrome.cast.ReceiverAvailability.AVAILABLE) {
      console.log("Receiver Available");
    }
  }
  
  function sessionListener(e) {
    console.log("Session event");
    console.dir(e);
    
    var session = e;
    if (session.media.length != 0) {
      onMediaDiscovered('onRequestSessionSuccess', session.media[0]);
    }
  }
  
  function onInitSuccess() {
    console.log("Cast initialized successfully.");
  }
  
  function onError(e) {
    console.log("Cast initialization error!");
    console.dir(e);
  }
  
  window.launchSession = function() {
    console.log("Launching Cast session...");
    
    chrome.cast.requestSession(onRequestSessionSuccess, onLaunchError);
  }
  
  function onRequestSessionSuccess(e) {
    console.log("Session launched!");
    console.log(e);
    
    var session = e;
    
    sendMessage(session, "Hello from the sender!");
  }
  
  function onLaunchError(e) {
    console.log("Session launch error!");
    console.log(e);
  }
  
  function sendMessage(session, body) {
    session.sendMessage(MSG_NAMESPACE, "Hello?", onSendMsgSuccess, onSendMsgError);
  }
  
  function onSendMsgSuccess(e) {
    console.log("Message sent successfully.");
    console.dir(e);
  }
  
  function onSendMsgError(e) {
    console.log("Messaging error!");
    console.dir(e);
  }
}());
        </script>
    </body>
</html>

<h1>Test</h1>
